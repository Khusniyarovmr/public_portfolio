select * from crypto.signal
select * from crypto.user
select * from crypto.position

select * from crypto.user_trade_strategy
select * from crypto.user_trading_status
select * from crypto.black_list
select count(symbol), count(pair) from crypto.symbol
select * from crypto.symbol where pair = 'MATICUSDT'
select * from crypto.strategy_tp_and_sl;

insert into crypto.user_trading_status (user_id, status, update_time)
values (1, true, to_date('29.03.2023', 'dd.mm.yyyy'))

insert into crypto.symbol (symbol, update_date, price, in_strategy, is_enable)
values ('OPUSDT', to_date('29.03.2023', 'dd.mm.yyyy'), 1.4143, 1, 1)

update crypto.user set role_id = 2 where id = 1;

alter table crypto.user_trade_strategy add column stock_market varchar(50);
truncate table crypto.user_trade_strategy;
ALTER SEQUENCE user_trade_strategy_id_seq RESTART WITH 1
truncate table crypto.strategy_tp_and_sl;
ALTER SEQUENCE strategy_tp_and_sl_id_seq RESTART WITH 1
truncate table crypto.signal;
ALTER SEQUENCE signal_id_seq RESTART WITH 1;

truncate table alembic_version;

truncate table crypto.symbol;

drop table crypto.role;
drop table crypto.signal;
drop table crypto.strategy;
drop table crypto.strategy_tp_and_sl;
drop table crypto.symbol;
drop table crypto.user;
drop table crypto.user_account_info;
drop table crypto.user_settings;
drop table crypto.user_trade_strategy;
drop table crypto.user_trading_status;

select * from crypto.strategy_tp_and_sl;

INSERT INTO crypto.strategy_tp_and_sl (strategy_id, type, lot_volume, price_by_margin, price_by_price, callbackrate, bind)
VALUES (1, 'trailing_stop', 0.0, 0.0, 2.0, 1.0, 0.0)
ON CONFLICT (id) WHERE id IS NULL
DO UPDATE SET strategy_id = excluded.strategy_id, type = excluded.type, lot_volume = excluded.lot_volume, price_by_margin = excluded.price_by_margin, price_by_price = excluded.price_by_price, callbackrate = excluded.callbackrate, bind = excluded.bind
RETURNING strategy_tp_and_sl.id;

select a.name, a.symbol, a.type, a.action, a.point from crypto.signal a
join
(
select b.name, b.symbol, max(b.id) max_id from crypto.signal b group by b.name, b.symbol
) c on a.name=c.name and a.symbol=c.symbol and a.id=c.max_id

INSERT INTO crypto.user_settings (user_id, stock_market, hashed_key, hashed_secret, update_date, is_enable, is_active)
VALUES (1, 'Bybit', 'my_hashed_key', 'my_hashed_secret', to_date('20.03.2023', 'dd.MM.yyyy'), 1, 1)








